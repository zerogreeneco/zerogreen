<!DOCTYPE html>
<th:block th:replace="~{basic/basicTemplate :: setContent(~{this::content})}" xmlns:th="http://www.w3.org/1999/xhtml">
    <th:block th:fragment="content">
        <script th:inline="javascript">
            $(function (){

                let boardId = $("#id").val();

                $("#like-btn").click(function (){

                    $.ajax({
                        url: "/zerogreen/community/like/" + boardId,
                        method: "post",
                        dataType: "json",
                        data: {
                            boardId: boardId
                        }
                    })
                        .done(function (data) {
                        if (data.count === 1) {
                            $(".like-img").attr("src", "/zerogreen/bootstrap/images/like/disLike.png")
                            // $("#like-btn").html("üòí");
                            $(".test-count").text(data.totalCount);
                            console.log(data.totalCount)
                        } else if (data.count === 0) {
                            $(".like-img").attr("src", "/zerogreen/bootstrap/images/like/like.png")
                            // $("#like-btn").html("üòç");
                            $(".test-count").text(data.totalCount);
                            console.log(data.totalCount)
                        }
                    });
                }); // like-btn end.

                $("#review-send-btn").click(function (){

                    let text = $("#text").val();
                    console.log("Text= " + text)
                    $.ajax({
                       url: "/zerogreen/community/" + boardId + "/reply",
                       method: "post",
                       data: {
                           boardId: boardId,
                           text: text
                       }
                    })
                    .done(function (fragment) {
                        console.log("ÎåìÍ∏Ä ÏÑ±Í≥µ");
                        $("#review-table").replaceWith(fragment);
                    });
                })
            });
        </script>
        <div th:object="${detailView}">
            <!-- ÏÉÅÏÑ∏Î≥¥Í∏∞ Ï†úÎ™© -->
            <input type="hidden" th:field="*{id}">
            <h1 th:field="*{category}" th:text="*{category.categoryName}"></h1>
            <h2 th:field="*{title}" th:text="*{title}"></h2>
            <p th:field="*{nickname}" th:text="*{nickname}"></p>
            <div th:field="*{modifiedDate}" th:text="${#temporals.format(detailView.modifiedDate, 'yyyy-MM-dd HH:mm')}"></div>
            <div th:field="*{count}" th:text="*{count}"></div>
            <div sec:authorize="isAuthenticated()" id="like-wrapper">
                <div class="like-count" th:if="${likeCount} == 0" >
                    <span id="like-btn"><img th:attr="src = @{/bootstrap/images/like/disLike.png}" class="like-img"></span>
                    <span class="test-count">[[*{like}]]</span>
                </div>
                <div class="like-count" th:if="${likeCount} == 1" >
                    <span id="like-btn"><img th:attr="src = @{/bootstrap/images/like/like.png}" class="like-img"></span>
                    <span class="test-count">[[*{like}]]</span>
                </div>
            </div>
            <div sec:authorize="isAnonymous()">
                <div><img th:attr="src = @{/bootstrap/images/like/like.png}" class="like-img"> [[*{like}]]</div>
            </div>
        </div>
        <!-- ÏÉÅÏÑ∏Î≥¥Í∏∞ ÎÇ¥Ïö© -->
        <hr />
        <div th:object="${detailView}">
            <div th:field="*{text}" th:text="*{text}"></div>
        </div>
        <hr />
            <!-- ÏÉÅÏÑ∏Î≥¥Í∏∞ Î¶¨Î∑∞ -->
        <div id="cm-review-wrapper">
            <div class="review-send" sec:authorize="isAuthenticated()">
                <form th:object="${reply}" method="post">
                    <textarea th:field="*{text}"></textarea>
                </form>
                    <button type="button" id="review-send-btn">Î¶¨Î∑∞ ÏûëÏÑ±</button>
            </div>
            <div id="review-table">
                <div th:each="replyList : ${replyList}">
                    <div th:text="${replyList.replier}"></div>
                    <div th:text="${replyList.text}"></div>
                    <div th:text="${#temporals.format(replyList.createdTime, 'yyyy-MM-dd HH:mm')}"></div>
                    <hr />
                </div>
            </div>
        </div>
    </th:block>
</th:block>
</html>
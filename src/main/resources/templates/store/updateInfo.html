<!DOCTYPE html>
<th:block th:replace="~{basic/basicTemplate :: setContent(~{this::content})}" xmlns:th="http://www.w3.org/1999/xhtml"
          xmlns:sec="http://www.w3.org/1999/xhtml">
    <th:block th:fragment="content">

        <!-- ÌéòÏù¥ÏßÄ css/ js Ï∂îÍ∞Ä -->
        <script th:src="@{/bootstrap/js/store/storeInfo.js}"></script>
        <link rel="stylesheet" th:href="@{/bootstrap/css/register.css}">
        <link rel="stylesheet" th:href="@{/bootstrap/css/store/store.css}">

        <!-- Î≥∏Î¨∏ ÏãúÏûë -->
        <div sec:authorize="isAuthenticated()">
            <div style="margin: 2em 0 !important;" sec:authorize="hasRole('ROLE_STORE')">
                <div class="center-box">
                    <div class="py-5 text-center">
                        <h2 class="title"><span>ÎÇ¥ Í∞ÄÍ≤å Ï†ïÎ≥¥ ÏàòÏ†ï</span></h2>
                    </div>
                    <div class="store-info">
                        <!-- Îß§Ïû• Ïù¥Î¶Ñ -->
                        <h3 class="title">
                            <img class="grade" th:src="@{/bootstrap/images/profile/STORE.png}">
                            <span id="store-name" th:text="${storeInfo.storeName}"/>
                        </h3>

                        <!-- ÏÇ¨ÏóÖÏû• Ï¢ÖÎ•ò -->
                        <label class="join-label">ÏÇ¨ÏóÖÏû• Ï¢ÖÎ•ò</label>
                        <div class="storeType">
                            <div th:each="stores : ${storeTypes}">
                                <input type="radio" style="margin-left: 10px;" th:value="${stores}"
                                       th:checked="${stores == storeInfo.storeType}" disabled>
                                <label th:text="${stores.storeType}"/>
                            </div>
                        </div>
                    </div>

                    <form method="post" th:action="@{/stores/update}" th:object="${storeInfo}"
                          enctype="multipart/form-data">

                        <input type="hidden" th:field="*{storeName}">
                        <input type="hidden" th:field="*{storeType}">

                        <div class="update-info">
                            <!-- Í∞ÄÍ≤å Ïó∞ÎùΩÏ≤ò -->
                            <div>
                                <label for="storePhoneNumber" class="join-label">Í∞ÄÍ≤å Ï†ÑÌôîÎ≤àÌò∏</label>
                                <input type="text" class="form-control input-box" id="storePhoneNumber"
                                       th:field="*{storePhoneNumber}"
                                       onkeyup="this.value=this.value.replace(/[^0-9]/g,'');">
                                <div th:errors="*{storePhoneNumber}" class="field-error">
                                    Í∞ÄÍ≤å Ïó∞ÎùΩÏ≤òÎ•º ÏûÖÎ†•Ìï¥ Ï£ºÏÑ∏Ïöî
                                </div>
                                <span class="field-error" id="phoneCheck"></span>
                            </div>

                            <!-- ÏòÅÏóÖÏãúÍ∞Ñ -->
                            <div>
                                <label class="join-label">ÏòÅÏóÖÏãúÍ∞Ñ</label>
                                <input type="time" class="time startTime" th:field="*{openTime}"/>
                                ~ <input type="time" class="time closeTime" th:field="*{closeTime}"/>
                            </div>

                            <!-- Í∞ÄÍ≤å ÏÜåÍ∞ú -->
                            <div>
                                <label for="storeDescription" class="join-label">Í∞ÄÍ≤å ÏÜåÍ∞ú
                                    <span class="cm-text-count">0 / 300</span></label>
                                <textarea class="form-control update-box description" id="storeDescription"
                                          th:field="*{storeDescription}" onkeyup="limitTextInput(this)"></textarea>
                                <p id="textCheck"/>
                            </div>

                            <!-- ÏÜåÏÖú Ï£ºÏÜå -->
                            <div>
                                <label class="join-label">ÏÜåÏÖú Ï£ºÏÜå</label>
                                <input type="text" class="form-control update-box"
                                       th:field="*{socialAddress1}">
                                <div th:if="*{socialAddress2}==null">
                                    <img class="add" id="socialAdd" th:src="@{/bootstrap/images/add.png}"
                                         onclick="socialAdd()">
                                    <input type="text" class="form-control update-box"
                                           th:field="*{socialAddress2}" hidden>
                                </div>
                                <div th:unless="*{socialAddress2}==null">
                                    <input type="text" class="form-control update-box"
                                           th:field="*{socialAddress2}">
                                </div>
                            </div>

                            <!-- Î©îÎâ¥ / ÏÉÅÌíà -->
                            <!-- VEGAN FOOD -->
                            <div>
                                <label class="join-label" th:unless="${storeInfo.storeType.name() == 'ECO_SHOP'}">Î©îÎâ¥</label>
                                <label class="join-label" th:if="${storeInfo.storeType.name() == 'ECO_SHOP'}">ÏÉÅÌíà</label>
                                <input type="text" class="form-control menu" id="menuName" placeholder="Ïù¥Î¶Ñ">
                                <input type="text" class="form-control price" id="menuPrice"
                                       onkeyup="inputPriceFormat(this)" placeholder="Í∞ÄÍ≤©">
                                <p id="inputCheck"/>
                            </div>
                            <!-- ÎπÑÍ±¥ Îì±Í∏â -->
                            <div th:if="${storeInfo.storeType.name() == 'VEGAN_FOOD'}">
                                    <label th:each="vegan : ${vegan}">
                                        <input type="radio" style="display: none" name="vegetarianGrade"
                                               th:value="${vegan.name()}">
                                        <img class="grade"
                                             th:src="@{'/bootstrap/images/profile/'+${vegan.name()}+'.png'}">
                                    </label>
                                    <p id="gradeCheck"/>
                            </div>

                            <span class="addBtn" th:if="${storeInfo.storeType.name() == 'VEGAN_FOOD'}"
                                  onclick="menuAdd()">Î©îÎâ¥ Ï∂îÍ∞Ä</span>
                            <span class="addBtn" th:if="${storeInfo.storeType.name() == 'GENERAL_FOOD'}"
                                  onclick="tableAdd()">Î©îÎâ¥ Ï∂îÍ∞Ä</span>
                            <span class="addBtn" th:if="${storeInfo.storeType.name() == 'ECO_SHOP'}"
                                  onclick="tableAdd()">ÏÉÅÌíà Ï∂îÍ∞Ä</span>

                            <!-- Î©îÎâ¥ Î™©Î°ù -->
                            <div>
                                <label class="join-label" th:unless="${storeInfo.storeType.name() == 'ECO_SHOP'}">Î©îÎâ¥
                                    Î™©Î°ù</label>
                                <label class="join-label" th:if="${storeInfo.storeType.name() == 'ECO_SHOP'}">ÏÉÅÌíà
                                    Î™©Î°ù</label>
                                <!-- Grade Table -->
                                <div class="table" th:if="${storeInfo.storeType.name() == 'VEGAN_FOOD'}">
                                    <table id="grade-table">
                                        <tr>
                                            <td style="width: 40%;">Ïù¥Î¶Ñ</td>
                                            <td style="width: 19%; border-left: 1px solid lightgray;">Í∞ÄÍ≤©</td>
                                            <td style="width: 18%; border-left: 1px solid lightgray;">ÎπÑÍ±¥Îì±Í∏â</td>
                                            <td style="width: 13%; border-left: 1px solid lightgray;">ÏÇ≠Ï†ú</td>
                                        </tr>
                                        <tr th:each="tableList : ${tableList}">
                                            <td style="width: 40%;">[[${tableList.menuName}]]</td>
                                            <td style="width: 19%; border-left: 1px solid lightgray;">
                                                [[${tableList.menuPrice}]]
                                            </td>
                                            <td style="width: 18%; border-left: 1px solid lightgray;">
                                                [[${tableList.vegetarianGrade}]]
                                            </td>
                                            <td style="width: 13%; border-left: 1px solid lightgray;">
                                                <input type="hidden" class="tableId" th:value="${tableList.id}">
                                                <img class="truncate_icon"
                                                     th:src="@{/bootstrap/images/list/close.png}"
                                                     onclick="gradeDel(this)"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div> <!-- end Grade Table -->

                                <!-- Table -->
                                <div class="table" th:unless="${storeInfo.storeType.name() == 'VEGAN_FOOD'}">
                                    <table id="list-table">
                                        <tr>
                                            <td style="width: 60%;">Ïù¥Î¶Ñ</td>
                                            <td style="width: 25%; border-left: 1px solid lightgray;">Í∞ÄÍ≤©</td>
                                            <td style="width: 15%; border-left: 1px solid lightgray;">ÏÇ≠Ï†ú</td>
                                        </tr>
                                        <tr th:each="tableList : ${tableList}">
                                            <td style="width: 60%;">[[${tableList.menuName}]]</td>
                                            <td style="width: 25%; border-left: 1px solid lightgray;">
                                                [[${tableList.menuPrice}]]
                                            </td>
                                            <td style="width: 15%; border-left: 1px solid lightgray;">
                                                <input type="hidden" class="tableId" th:value="${tableList.id}">
                                                <img class="truncate_icon"
                                                     th:src="@{/bootstrap/images/list/close.png}"
                                                     onclick="tableDel(this)"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div> <!-- end Table -->
                            </div> <!-- end MenuList -->

                            <!-- Ï≤®Î∂Ä ÌååÏùº -->
                            <div>
                                <label class="join-label">Í∞ÄÍ≤å ÏÇ¨ÏßÑ</label>
                                <input type="file" multiple="multiple" class="input-box" th:field="*{uploadFiles}"
                                       accept="image/jpg,image/png,image/jpeg,image/gif">
                                <div id="selectedImg"><img src=""/></div>
                            </div>

                            <div th:if="${#fields.hasGlobalErrors()}">
                                <p class="field-error" th:each="err : ${#fields.globalErrors()}" th:text="${err}">Í∏ÄÎ°úÎ≤å Ïò§Î•ò Î©îÏãúÏßÄ</p>
                            </div>
                            <p id="imgCheck"/>

                            <hr>
                            <div class="img-list" th:if="${storeImageList.size() > 0}">
                                <span id="img-left" class="arrow arrow-left">&#139;</span>
                                <span id="img-right" class="arrow arrow-right">&#155;</span>
                                <div id="img-box">
                                    <div class="img-slider">
                                        <div class="store-img" th:each="sImg: ${storeImageList}">
                                            <input type="hidden" class="imgId" th:value="${sImg.imageId}">
                                            <input type="hidden" class="filePath" th:value="${sImg.filePath}">
                                            <input type="hidden" class="thumb" th:value="${sImg.thumbPath}">
                                            <img th:src="@{/stores/update/image/} + ${sImg.storeMember.storeName} +${sImg.thumbnailName}"
                                                 th:value="${sImg.thumbnailName}" width="150px" height="150px">
                                            <img class="truncate_icon"
                                                 th:src="@{/bootstrap/images/list/close.png}"
                                                 onclick="imgDel(this)"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div>
                            <button id="modifyBtn" class="regi-btn" type="submit">ÏàòÏ†ïÌïòÍ∏∞</button>
                        </div>
                    </form>
                </div>
            </div>
            <div style="margin: 2em 0 !important;" sec:authorize="hasRole('ROLE_UN_STORE')">
                <div class="center-box">
                    <span id="sorry-emoji">üòÖ</span>
                    <span id="sorry-text">Í¥ÄÎ¶¨Ïûê ÏäπÏù∏ ÎåÄÍ∏∞ Ï§ë ÏûÖÎãàÎã§.</span>
                </div>
            </div>
        </div>
    </th:block>
</th:block>